<view class="uni-common-mt"><form><block wx:if="{{edit=='1'}}"><input data-event-opts="{{[['input',[['__set_model',['$0','id','$event',[]],['formData']]]]]}}" class="hidden" value="{{formData.id}}" bindinput="__e"/></block><view class="uni-form-item uni-row"><view class="title">申请人</view><input class="uni-input" placeholder="申请人" data-event-opts="{{[['input',[['__set_model',['$0','userName','$event',[]],['formData']]]]]}}" value="{{formData.userName}}" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title">申请公司</view><block wx:if="{{formData.companyId}}"><d-picker class="uni-input" vue-id="7a329209-1" companyId="{{formData.companyId}}" deptId="{{formData.deptId}}" data-event-opts="{{[['^getDeptV',[['getDeptV']]]]}}" bind:getDeptV="__e" bind:__l="__l"></d-picker></block></view><view class="uni-form-item uni-row"><view class="title">项目</view><input data-event-opts="{{[['input',[['__set_model',['$0','projectId','$event',[]],['formData']]]]]}}" class="hidden" value="{{formData.projectId}}" bindinput="__e"/><input class="uni-input" name="title" placeholder="项目" data-event-opts="{{[['tap',[['togglePopup',['center','borrow']]]],['input',[['__set_model',['$0','title','$event',[]],['formData']]]]]}}" value="{{formData.title}}" bindtap="__e" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title"><label class="red _span">*</label>报销金额</view><input class="uni-input" name="money" type="number" placeholder="报销金额" data-event-opts="{{[['input',[['__set_model',['$0','money','$event',[]],['formData']],['Upcase']]]]}}" value="{{formData.money}}" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title"><label class="red _span">*</label>金额大写</view><input class="uni-input" name="moneyUpcase" placeholder="金额大写" data-event-opts="{{[['input',[['__set_model',['$0','moneyUpcase','$event',[]],['formData']]]]]}}" value="{{formData.moneyUpcase}}" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title">报销人</view><input class="uni-input" name="receiver" placeholder="报销人" data-event-opts="{{[['input',[['__set_model',['$0','receiver','$event',[]],['formData']],['getReceiverList',['$event']]]]]}}" value="{{formData.receiver}}" bindinput="__e"/></view><block wx:if="{{receiverList.length>0}}"><scroll-view style="height:180rpx;text-align:center;background-color:#F7F7F7;" scroll-y><block wx:for="{{receiverList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['choicePayee',[index]]]]]}}" class="payee-item" bindtap="__e">{{''+item.payee+''}}</view></block></scroll-view></block><view class="uni-form-item uni-row"><view class="title">收款账号</view><input class="uni-input" name="receiverAccount" placeholder="收款账号" data-event-opts="{{[['input',[['__set_model',['$0','receiverAccount','$event',[]],['formData']]]]]}}" value="{{formData.receiverAccount}}" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title">收款开户行</view><input class="uni-input" name="receiverOpenBank" placeholder="收款开户行" data-event-opts="{{[['input',[['__set_model',['$0','receiverOpenBank','$event',[]],['formData']]]]]}}" value="{{formData.receiverOpenBank}}" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title">实际报销金额</view><input class="uni-input" name="actualMoney" disabled="true" placeholder="实际报销金额" data-event-opts="{{[['input',[['__set_model',['$0','actualMoney','$event',[]],['formData']]]]]}}" value="{{formData.actualMoney}}" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title">金额大写</view><input class="uni-input" name="actualMoneyUpcase" disabled="true" placeholder="金额大写" data-event-opts="{{[['input',[['__set_model',['$0','actualMoneyUpcase','$event',[]],['formData']]]]]}}" value="{{formData.actualMoneyUpcase}}" bindinput="__e"/></view><view><view class=" list-pd filebox"><view class=" cell-pd"><view class="uni-uploader"><view class="uni-uploader-head"><view class="uni-uploader-title"><text class="filetitlee">附件:</text>(点击可预览选好的图片)</view><view class="uni-uploader-info">{{imageList.length+"/9"}}</view></view><view class="uni-uploader-body"><view class="uni-uploader__files"><block wx:for="{{imageList}}" wx:for-item="image" wx:for-index="index" wx:key="index"><block class="uni-uploader_close"><block wx:if="{{!os}}"><view class="uni-uploader__file uni-uploader_close"><image class="uni-uploader__img" webp="true" src="{{image}}" data-src="{{image}}" data-event-opts="{{[['tap',[['previewImage',['$event']]]]]}}" bindtap="__e"></image><view data-event-opts="{{[['tap',[['deleImage',[index]]]]]}}" class="closeBtn" catchtap="__e"><text class="closeB"></text>X</view></view></block><block wx:else><view class="uni-flex uni-row" style="-webkit-flex-wrap:wrap;flex-wrap:wrap;"><view class="uni-center" style="width:280rpx;padding:0 10px;"><uni-icons vue-id="{{'7a329209-2-'+index}}" type="paperclip" size="40" data-event-opts="{{[['^tap',[['gotoFile',['$0'],[[['imageList','',index]]]]]]]}}" bind:tap="__e" bind:__l="__l"></uni-icons></view></view></block></block></block><view class="uni-uploader__input-box"><view data-event-opts="{{[['tap',[['chooseImage',['0']]]]]}}" class="uni-uploader__input" bindtap="__e"></view></view></view></view></view></view></view></view><view class="borrow"><button class="mini-btn borrowbtn" type="info" data-event-opts="{{[['tap',[['togglePopup',['center','detail']]]]]}}" bindtap="__e">报销明细</button><block wx:if="{{reimDetail.length!=0}}"><view class="borrowBox"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="borrowitem"><view>{{"报销事由："+item.$orig.reimbursementReason}}</view><view>{{"报销类型："+item.m0}}</view><view>{{"报销金额："+item.$orig.money}}</view><view>{{"关联表单类型："+item.m1}}</view><view>{{"关联表单："+item.$orig.relationId}}</view><uni-icons class="btnclose" vue-id="{{'7a329209-3-'+index}}" type="close" color="#cccccc" size="40" data-event-opts="{{[['^tap',[['dele',[index,'2']]]]]}}" bind:tap="__e" bind:__l="__l"></uni-icons></view></block></view></block></view><block wx:if="{{edit=='1'}}"><view class="borrow"><view class="borrowtitle">扣款明细</view><block wx:if="{{cutPayment.length!=0}}"><view class="borrowBox"><block wx:for="{{cutPayment}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="borrowitem"><view>{{"审批人："+item.userName}}</view><view>{{"扣款事由："+item.reason}}</view><view>{{"扣款金额："+item.money}}</view></view></block></view></block></view></block><view class="button-sp-area"><block wx:if="{{formData.status=='99'||formData.status==''}}"><button class="mini-btn" type="info" size="mini" loading="{{loading1}}" data-event-opts="{{[['tap',[['submit',['0']]]]]}}" bindtap="__e">保存草稿</button></block><block wx:if="{{formData.status=='99'||formData.status==''}}"><button class="mini-btn" type="primary" loading="{{loading2}}" size="mini" data-event-opts="{{[['tap',[['submit',['1']]]]]}}" bindtap="__e">提交</button></block><block wx:if="{{formData.status=='3'}}"><button class="mini-btn" type="primary" size="mini" data-event-opts="{{[['tap',[['submit',['2']]]]]}}" bindtap="__e">提交</button></block><block wx:if="{{formData.status!=''&&formData.status!='2'&&formData.status!='16'&&formData.status!='99'}}"><button class="mini-btn cui-btn-2" type="info" loading="{{loading3}}" size="mini" data-event-opts="{{[['tap',[['urge']]]]}}" bindtap="__e">催办</button></block><block wx:if="{{formData.status!='99'&&formData.status!=''}}"><button class="mini-btn cui-btn-1" type="info" size="mini" data-event-opts="{{[['tap',[['send']]]]}}" bindtap="__e">抄送</button></block></view></form><block wx:if="{{edit=='1'&&procInstId}}"><uni-process vue-id="7a329209-4" baseUrl="{{baseUrl}}" procInstId="{{procInstId}}" mid="{{mid}}" bind:__l="__l"></uni-process></block><uni-popup vue-id="7a329209-5" show="{{showborrow}}" type="{{type}}" mask-click="{{false}}" data-event-opts="{{[['^change',[['change']]]]}}" bind:change="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="uni-tip"><text class="uni-tip-title">选择项目</text><scroll-view class="uni-tip-content" scroll-y="true" data-event-opts="{{[['scrolltolower',[['borrowlower',['$event']]]]]}}" bindscrolltolower="__e"><block wx:if="{{projects.data.length==0}}"><view class="loading-more"><text class="loading-more-text">暂无项目！</text></view></block><block wx:else><view class="uni-list"><radio-group data-event-opts="{{[['change',[['checkboxChange',['$event']]]]]}}" bindchange="__e"><block wx:for="{{projects.data}}" wx:for-item="item" wx:for-index="index" wx:key="id"><label class="uni-list-cell uni-list-cell-pd"><view><radio value="{{item.id}}" checked="{{index===currentP}}"></radio></view><view><view>{{"项目编号："+item.code}}</view><view>{{"负责人："+item.managerName}}</view><view>{{"项目名称："+item.projectName}}</view><view>{{"项目名称："+item.projectName}}</view></view></label></block></radio-group></view></block><block wx:if="{{projects.isLoading||projects.total>projects.pageSize}}"><view class="loading-more"><text class="loading-more-text">{{projects.noneText}}</text></view></block></scroll-view><view class="uni-tip-group-button"><text data-event-opts="{{[['tap',[['cancel',['borrow']]]]]}}" class="uni-tip-button" bindtap="__e">取消</text><text data-event-opts="{{[['tap',[['cancel',['borrow','1']]]]]}}" class="uni-tip-button" bindtap="__e">确定</text></view></view></uni-popup><uni-popup vue-id="7a329209-6" show="{{showdetail}}" type="{{type}}" mask-click="{{false}}" data-event-opts="{{[['^change',[['change']]]]}}" bind:change="__e" bind:__l="__l" vue-slots="{{['default']}}"><view class="uni-tip"><text class="uni-tip-title">报销明细</text><view class="uni-tip-content uni-tip-content-detail"><form><view class="uni-form-item uni-row"><view class="title">事由</view><input class="uni-input" placeholder="事由" name="reimbursementReason" data-event-opts="{{[['input',[['__set_model',['$0','reimbursementReason','$event',[]],['details']]]]]}}" value="{{details.reimbursementReason}}" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title">报销类型</view><input class="hidden" placeholder="报销类型" name="reimbursementType" data-event-opts="{{[['input',[['__set_model',['$0','reimbursementType','$event',[]],['details']]]]]}}" value="{{details.reimbursementType}}" bindinput="__e"/><view data-event-opts="{{[['tap',[['togglePopup',['center','type']]]]]}}" class="uni-input" bindtap="__e">{{$root.m2}}</view></view><view class="uni-form-item uni-row"><view class="title">报销金额</view><input class="uni-input" placeholder="报销金额" name="money" data-event-opts="{{[['input',[['__set_model',['$0','money','$event',[]],['details']]]]]}}" value="{{details.money}}" bindinput="__e"/></view><view class="uni-form-item uni-row"><view class="title">关联表单类型</view><input class="uni-input hidden" placeholder="关联表单类型" name="relationType" data-event-opts="{{[['input',[['__set_model',['$0','relationType','$event',[]],['details']]]]]}}" value="{{details.relationType}}" bindinput="__e"/><picker class="picker" value="{{$root.m3}}" range="{{relationTypeList}}" range-key="dictLabel" data-event-opts="{{[['change',[['relationTypeChange',['$event']]]]]}}" bindchange="__e"><view class="uni-input">{{(relationTypeList[index1]?relationTypeList[index1]:{}).dictLabel}}</view></picker></view><view class="uni-form-item uni-row"><view class="title">关联表单</view><input data-event-opts="{{[['tap',[['togglePopup',['center','link']]]],['input',[['__set_model',['$0','relationId','$event',[]],['details']]]]]}}" class="uni-input" value="{{details.relationId}}" bindtap="__e" bindinput="__e"/></view></form></view><view class="uni-tip-group-button"><text data-event-opts="{{[['tap',[['cancel',['detail']]]]]}}" class="uni-tip-button" bindtap="__e">取消</text><text data-event-opts="{{[['tap',[['cancel',['detail','2']]]]]}}" class="uni-tip-button" bindtap="__e">确定</text></view></view></uni-popup><uni-popup vue-id="7a329209-7" show="{{showtype}}" type="{{type}}" mask-click="{{false}}" bind:__l="__l" vue-slots="{{['default']}}"><view class="uni-tip"><text class="uni-tip-title">选择报销类型</text><scroll-view class="uni-tip-content" scroll-y="true"><view class="uni-list"><radio-group data-event-opts="{{[['change',[['radioChange',['$event']]]]]}}" bindchange="__e"><block wx:for="{{remitypes}}" wx:for-item="item" wx:for-index="index" wx:key="dictValue"><label class="uni-list-cell uni-list-cell-pd"><view><radio value="{{item.dictValue}}" checked="{{index===current}}"></radio></view><view><view>{{"标签："+item.dictLabel}}</view><view>{{"备注："+item.remark}}</view><view>{{"键值："+item.dictValue}}</view></view></label></block></radio-group></view></scroll-view><view class="uni-tip-group-button"><text data-event-opts="{{[['tap',[['cancel',['type']]]]]}}" class="uni-tip-button" bindtap="__e">取消</text><text data-event-opts="{{[['tap',[['cancel',['type','3']]]]]}}" class="uni-tip-button" bindtap="__e">确定</text></view></view></uni-popup><uni-popup vue-id="7a329209-8" show="{{showlink}}" type="{{type}}" mask-click="{{false}}" bind:__l="__l" vue-slots="{{['default']}}"><view class="uni-tip"><text class="uni-tip-title">选择关联表单</text><scroll-view class="uni-tip-content" scroll-y="true" data-event-opts="{{[['scrolltolower',[['borrowlowerLinks',['$event']]]]]}}" bindscrolltolower="__e"><block wx:if="{{linkForm.data.length==0}}"><view class="loading-more"><text class="loading-more-text">暂无数据！</text></view></block><block wx:else><view class="uni-list"><radio-group data-event-opts="{{[['change',[['radioChange',['$event']]]]]}}" bindchange="__e"><block wx:for="{{linkForm.data}}" wx:for-item="item" wx:for-index="index" wx:key="id"><label class="uni-list-cell uni-list-cell-pd"><view><radio value="{{item.id}}" checked="{{index===currentRelation}}"></radio></view><block wx:if="{{details.relationType=='oatravel'}}"><view><view>{{"出差天数："+item.applyDays}}</view><view>{{"出差原因："+item.applyReason}}</view><view>{{"乘坐交通工具："+item.vehicle}}</view></view></block><block wx:if="{{details.relationType=='oaOutgoing'}}"><view><view>{{"外出起始时间："+item.goOutStart}}</view><view>{{"外出结束时间："+item.goOutEnd}}</view><view>{{"外出时长："+item.goOutHour}}</view><view>{{"外出事由："+item.reason}}</view></view></block><block wx:if="{{details.relationType=='oaOvertime'}}"><view><view>{{"加班起始日期："+item.workStart}}</view><view>{{"加班结束日期："+item.workEnd}}</view><view>{{"加班时长："+item.workHour}}</view><view>{{"加班事由："+item.reason}}</view></view></block><block wx:if="{{details.relationType=='jyTender'}}"><view><view>{{"工程名称："+item.projectName}}</view><view>{{"申请人："+item.applier}}</view><view>{{"开标时间："+item.openTenderDate}}</view></view></block></label></block></radio-group></view></block><block wx:if="{{linkForm.isLoading||linkForm.total>linkForm.pageSize}}"><view class="loading-more"><text class="loading-more-text">{{linkForm.noneText}}</text></view></block></scroll-view><view class="uni-tip-group-button"><text data-event-opts="{{[['tap',[['cancel',['link']]]]]}}" class="uni-tip-button" bindtap="__e">取消</text><text data-event-opts="{{[['tap',[['cancel',['link','4']]]]]}}" class="uni-tip-button" bindtap="__e">确定</text></view></view></uni-popup></view>