(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/oa/oaReceivables/oaReceivables"],{"146a":function(t,e,i){"use strict";i.r(e);var a=i("cb98"),o=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,(function(){return a[t]}))}(n);e["default"]=o.a},a257:function(t,e,i){"use strict";var a=i("aa87"),o=i.n(a);o.a},a679:function(t,e,i){"use strict";(function(t){i("8485");a(i("66fd"));var e=a(i("c5c2"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},aa87:function(t,e,i){},c5c2:function(t,e,i){"use strict";i.r(e);var a=i("f7fd"),o=i("146a");for(var n in o)"default"!==n&&function(t){i.d(e,t,(function(){return o[t]}))}(n);i("a257");var s,r=i("f0c5"),c=Object(r["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],s);e["default"]=c.exports},cb98:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(i("05b7")),o=s(i("541c")),n=(s(i("bac4")),i("2f62"));function s(t){return t&&t.__esModule?t:{default:t}}var r=function(){Promise.all([i.e("common/vendor"),i.e("components/e-picker/e-picker")]).then(function(){return resolve(i("d113"))}.bind(null,i)).catch(i.oe)},c=function(){i.e("components/d-picker/d-picker").then(function(){return resolve(i("09d9"))}.bind(null,i)).catch(i.oe)},p=function(){i.e("components/uni-processList/nui-processList").then(function(){return resolve(i("8947"))}.bind(null,i)).catch(i.oe)},u=function(){Promise.all([i.e("common/vendor"),i.e("components/uni-uploader/uni-uploader")]).then(function(){return resolve(i("d7c2"))}.bind(null,i)).catch(i.oe)},l=function(){i.e("components/uni-relation-popup/uni-relation-popup").then(function(){return resolve(i("4f53"))}.bind(null,i)).catch(i.oe)},d={components:{ePicker:r,uniProcess:p,upload:u,dPicker:c,uniRelationPopup:l},data:function(){return{mid:"",edit:"0",user:{},os:!1,formData:{id:"",userName:"",projectId:"",projectName:"",companyId:"",companyName:"",deptId:"",deptName:"",receivablesDate:a.default.getDate("dateTime"),money:0,moneyUpcase:"",payee:"",reason:"",remark:"",status:""},details:{receivableType:"",paymentType:"",moneyPurpost:"",receivableCost:"",remark:""},borrows:{code:"",borrowReason:"",borrowAmount:"",offsetAmount:"",borrowMoney:""},detailList:[],borrowsList:[],baseUrl:"oa/oaReceivables",addUrl:"oa/oaReceivables/add",saveUrl:"oa/oaReceivables/saveDraft",editUrl:"oa/oaReceivables/modifyOaReceivables",flag:!1,index:0,dateStart:a.default.getDate("dateTime"),loading1:!1,loading2:!1,loading3:!1,procInstId:"",fileList:[],attachmentList:[],index1:0,receivableType:[],index2:0,paymentType:[],paymentTypeList:[],index3:0,moneyPurpost:[],moneyPurpostList:[],showdetail:!1,type:"",showpopup:!1,popupData:{titile:"工程",selectType:"radio",url:"oa/oaProject/list",popupType:"project"}}},computed:(0,n.mapState)(["name","deptId","companyId","hasLogin"]),onLoad:function(t){this.edit=t.edit||"0",this.mid=t.id||"";var e=this;"0"==this.edit&&(this.$set(this.formData,"userName",this.name),this.$set(this.formData,"companyId",this.companyId),this.$set(this.formData,"deptId",this.deptId)),this.dictValue("oa_receivable_type").then((function(t){e.receivableType=t.data})),this.dictValue("sys_pro_payment_type").then((function(t){e.paymentType=t.data})),this.dictValue("sys_pro_payment_type_relation").then((function(t){e.paymentTypeList=t.data})),"1"==this.edit&&(this.urlRequestGet(this.baseUrl+"/phoneEdit/"+this.mid,"text/html;charset=UTF-8",(function(t){a.default.listAssign(e.formData,t.data),e.index1=e.returnIndex(e.receivableType,e.formData.receivableType),e.procInstId=t.data.procInstId})),this.urlRequestPost("oa/oaAttachment/selectAttachByObjectId",{objId:this.mid},null,(function(t){for(var i in t.data.data)e.fileList.push(e.websiteUrl+t.data.data[i].attachmentName),e.attachmentList.push({objectId:e.id,attachmentName:t.data.data[i].attachmentName,fileName:t.data.data[i].fileNamess})})),this.urlRequestPost("oa/oaReceivables/detailList",{mainId:this.mid},null,(function(t){for(var i in t.data.rows)e.detailList.push(t.data.rows[i]);var a=function(t){var i=e.paymentTypeList.findIndex((function(i){return i.dictLabel==e.detailList[t].paymentType})),a=e.paymentTypeList[i].dictValue;e.dictValue(a).then((function(i){e.moneyPurpostList.push(e.getDictV(i.data,e.detailList[t].moneyPurpost))}))};for(var o in e.detailList)a(o)})),this.urlRequestPost("oa/oaBorrowMoney/getPhoneBorrowMoneyByOther",{tableColumn:"borrow_id",tableName:"oa_receivables_borrow",tableMid:"receivables_id",midValue:this.mid},null,(function(t){for(var i in console.log(t),t.data.rows)e.borrowsList.push(t.data.rows[i])})))},methods:{test:function(t){console.log(this.detailList),console.log(t)},submit:function(e){var i=this,a="",n={},s=[{name:"money",checkType:"notnull",checkRule:"",errorMsg:"金额必填"},{name:"moneyUpcase",checkType:"notnull",checkRule:"",errorMsg:"大写必填"}];n.oaReceivables=this.formData,n.receiveDetailList=this.detailList,n.relationList=this.borrowsList,n.attachmentList=this.attachmentList;var r=o.default.check(this.formData,s);if(r){switch(e){case"1":a=this.addUrl,this.loading2=!0;break;case"0":a=this.saveUrl,this.loading1=!0;break;case"2":a=this.editUrl,this.loading1=!0;break}this.urlRequestPost(a,n,"application/json;charset=UTF-8",(function(e){i.loading1=!1,i.loading2=!1,t.showToast({title:e.data.msg,icon:"none"}),"0"==e.data.code&&t.reLaunch({url:"../../start/start"})}))}else t.showToast({title:o.default.error,icon:"none"})},Upcase:function(t){var e=this;this.urlRequestGet("common/converMoneyToCN/"+t,"application/json;charset=UTF-8",(function(t){console.log(t.data),e.$set(e.formData,"moneyUpcase",t.data.msg)}))},receivableTypeFunc:function(t){this.index1=t.target.value,this.details.receivableType=this.receivableType[this.index1].dictValue},paymentTypeFunc:function(t){var e=this;this.index2=t.target.value,this.details.paymentType=this.paymentType[this.index2].dictValue;var i=this.paymentTypeList.findIndex((function(t){return t.dictLabel==e.details.paymentType})),a=this.paymentTypeList[i].dictValue;this.dictValue(a).then((function(t){e.moneyPurpost=t.data}))},moneyPurpostFunc:function(t){this.index3=t.target.value,this.details.moneyPurpost=this.moneyPurpost[this.index3].dictValue},togglePopup:function(t,e,i){switch(t){case"top":this.content="顶部弹出 popup";break;case"bottom":this.content="底部弹出 popup";break;case"center":this.content="居中弹出 popup";break}"detail"==e&&(this.details={receivableType:0,receivableCost:"",remark:""}),"2"==i&&(this.popupData.titile="工程",this.popupData.selectType="radio",this.popupData.url="oa/oaProject/phoneList",this.popupData.popupType="project"),"1"==i&&(this.popupData.titile="借款",this.popupData.selectType="checkbox",this.popupData.url="oa/oaBorrowMoney/phoneList",this.popupData.popupType="oaBorrowMoney"),this.type=t,this["show"+e]=!0},cancel:function(t,e){var i=this;if(this["show"+t]=!1,"1"==e){this.detailList.push(this.details),this.formData.money=parseFloat(this.formData.money)+parseFloat(this.details.receivableCost),console.log(this.formData.money),this.Upcase(this.formData.money);var a=this.paymentTypeList.findIndex((function(t){return t.dictLabel==i.details.paymentType})),o=this.paymentTypeList[a].dictValue;this.dictValue(o).then((function(t){i.moneyPurpostList.push(i.getDictV(t.data,i.details.moneyPurpost))}))}},dele:function(t,e){"1"==e?(this.formData.money=parseFloat(this.formData.money)-parseFloat(this.detailList[t].receivableCost),this.Upcase(this.formData.money),this.detailList.splice(t,1),this.moneyPurpostList.splice(t,1)):this.borrowsList.splice(t,1)},change:function(t){t.show||(this.showdetail=!1)},getDeptV:function(t){this.formData.deptId=t.deptId,this.formData.companyId=t.companyId},getAttachmentList:function(t){this.attachmentList=t},getData:function(t){if(t[0].popupType)if("project"==t[0].popupType)this.$set(this.formData,"projectId",t[0].id),this.$set(this.formData,"projectName",t[0].projectName),this.detailList=[],this.moneyPurpostList=[];else if("oaBorrowMoney"==t[0].popupType)for(var e in t)1!=this.ifAdd(t[e].id,this.borrowsList)&&(t[e].borrowId=t[e].id,this.borrowsList.push(t[e]))},ifAdd:function(t,e){var i=!1;for(var a in e)e[a].id==t&&(i=!0);return i},popupState:function(t){this.showpopup=t},changeStart:function(t){this.formData.receivablesDate=t}}};e.default=d}).call(this,i("543d")["default"])},f7fd:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return a}));var a={dPicker:function(){return i.e("components/d-picker/d-picker").then(i.bind(null,"09d9"))},ePicker:function(){return Promise.all([i.e("common/vendor"),i.e("components/e-picker/e-picker")]).then(i.bind(null,"d113"))},uniUploader:function(){return Promise.all([i.e("common/vendor"),i.e("components/uni-uploader/uni-uploader")]).then(i.bind(null,"d7c2"))},uniIcons:function(){return Promise.all([i.e("common/vendor"),i.e("components/uni-icons/uni-icons")]).then(i.bind(null,"1581"))},uniPopup:function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"d441"))},uniRelationPopup:function(){return i.e("components/uni-relation-popup/uni-relation-popup").then(i.bind(null,"4f53"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,0!=t.detailList.length?t.__map(t.detailList,(function(e,i){var a=t.__get_orig(e),o=e.receivableType?t.getDictV(t.receivableType,e.receivableType):null,n=e.paymentType?t.getDictV(t.paymentType,e.paymentType):null;return{$orig:a,m0:o,m1:n}})):null);t.$mp.data=Object.assign({},{$root:{l0:i}})},n=[]}},[["a679","common/runtime","common/vendor"]]]);