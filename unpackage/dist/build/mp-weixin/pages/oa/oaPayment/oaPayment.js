(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/oa/oaPayment/oaPayment"],{"0292":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(a("05b7")),n=s(a("541c")),o=(s(a("bac4")),a("2f62"));function s(t){return t&&t.__esModule?t:{default:t}}var p=function(){Promise.all([a.e("common/vendor"),a.e("components/e-picker/e-picker")]).then(function(){return resolve(a("d113"))}.bind(null,a)).catch(a.oe)},l=function(){a.e("components/d-picker/d-picker").then(function(){return resolve(a("09d9"))}.bind(null,a)).catch(a.oe)},r=function(){a.e("components/uni-processList/nui-processList").then(function(){return resolve(a("8947"))}.bind(null,a)).catch(a.oe)},c=function(){Promise.all([a.e("common/vendor"),a.e("components/uni-uploader/uni-uploader")]).then(function(){return resolve(a("d7c2"))}.bind(null,a)).catch(a.oe)},u=function(){a.e("components/uni-relation-popup/uni-relation-popup").then(function(){return resolve(a("4f53"))}.bind(null,a)).catch(a.oe)},d={components:{ePicker:p,uniProcess:r,upload:c,dPicker:l,uniRelationPopup:u},data:function(){return{mid:"",edit:"0",user:{},os:!1,formData:{id:"",userName:"",projectId:"",projectName:"",companyId:"",companyName:"",deptId:"",deptName:"",payDate:i.default.getDate("dateTime"),money:0,moneyUpcase:"",drawee:"",payType:"",expirationDate:i.default.getDate("date"),isAgent:0,receivablesId:"",companyPay:0,reason:"",remark:"",status:""},details:{paymentReason:"",money:"",payType:"",proCategory:"",detailCategory:"",payee:"",payeeAccount:"",payeeOpenBank:"",relationBillType:0,relationContractType:0,oweBillMoney:0,billExpirationDate:i.default.getDate("date"),oweContractMoney:0,contractExpirationDate:i.default.getDate("date"),relationBill:"",relationBillName:"",relationContract:"",relationContractName:""},detailList:[],baseUrl:"oa/oaPayment",addUrl:"oa/oaPayment/add",saveUrl:"oa/oaPayment/saveDraft",editUrl:"oa/oaPayment/modifyOaPayment",flag:!1,index:0,dateStart:i.default.getDate("dateTime"),loading1:!1,loading2:!1,loading3:!1,procInstId:"",fileList:[],attachmentList:[],index1:0,index2:0,index3:0,index4:0,index5:0,index6:0,index7:0,index8:0,index9:0,index10:0,yes_no:[],payType:[],payTypeProject:[],payType1:[],proCategory:[],detailCategory:[],relationBillType:[],relationContractType:[],payeeList:[],showdetail:!1,type:"",showpopup:!1,popupData:{titile:"收款",selectType:"radio",url:"oa/oaReceivables/list",popupType:"oaReceivables"}}},computed:(0,o.mapState)(["name","deptId","companyId","hasLogin"]),onLoad:function(t){this.edit=t.edit||"0",this.mid=t.id||"";var e=this;"0"==this.edit&&(this.$set(this.formData,"userName",this.name),this.$set(this.formData,"companyId",this.companyId),this.$set(this.formData,"deptId",this.deptId)),this.dictValue("sys_yes_no").then((function(t){e.yes_no=t.data})),this.dictValue("oa_payment_type").then((function(t){e.payType=t.data})),this.dictValue("sys_pro_pay_type").then((function(t){e.payTypeProject=t.data})),this.dictValue("oa_reimbursement_type").then((function(t){e.payType1=t.data})),this.dictValue("sys_payment_big_type").then((function(t){e.proCategory=t.data})),this.dictValue("sys_payment_small_type5").then((function(t){e.detailCategory=t.data})),this.dictValue("oa_payment_link").then((function(t){e.relationBillType=t.data})),this.dictValue("oa_payment_linkC").then((function(t){e.relationContractType=t.data})),"1"==this.edit&&(this.urlRequestGet(this.baseUrl+"/phoneEdit/"+this.mid,"text/html;charset=UTF-8",(function(t){i.default.listAssign(e.formData,t.data),console.log(e.formData),e.index1=e.returnIndex(e.yes_no,e.formData.isAgent),e.index2=e.returnIndex(e.yes_no,e.formData.companyPay),e.index3=e.returnIndex(e.payType,e.formData.payType),e.procInstId=t.data.procInstId})),this.urlRequestPost("oa/oaAttachment/selectAttachByObjectId",{objId:this.mid},null,(function(t){for(var a in t.data.data)e.fileList.push(t.data.data[a].attachmentUrl),e.attachmentList.push({objectId:e.id,attachmentName:t.data.data[a].attachmentName,fileName:t.data.data[a].fileNamess})})),this.urlRequestPost("oa/oaPaymentDetail/list",{parentId:this.mid},null,(function(t){for(var a in console.log(t),t.data.rows)e.detailList.push(t.data.rows[a])})))},methods:{submit:function(e){var a=this,i="",o={},s=[{name:"projectId",checkType:"notnull",checkRule:"",errorMsg:"项目必填"},{name:"money",checkType:"notnull",checkRule:"",errorMsg:"金额必填"},{name:"moneyUpcase",checkType:"notnull",checkRule:"",errorMsg:"大写必填"}];o.oaPayment=this.formData,o.detailList=this.detailList,o.attachmentList=this.attachmentList;var p=n.default.check(this.formData,s);if(p){switch(e){case"1":i=this.addUrl,this.loading2=!0;break;case"0":i=this.saveUrl,this.loading1=!0;break;case"2":i=this.editUrl,this.loading1=!0;break}this.urlRequestPost(i,o,"application/json;charset=UTF-8",(function(e){a.loading1=!1,a.loading2=!1,t.showToast({title:e.data.msg,icon:"none"}),"0"==e.data.code&&t.reLaunch({url:"../../start/start"})}))}else t.showToast({title:n.default.error,icon:"none"})},Upcase:function(t){var e=this;this.urlRequestGet("common/converMoneyToCN/"+t,"application/json;charset=UTF-8",(function(t){e.$set(e.formData,"moneyUpcase",t.data.msg)}))},isAgent:function(t){this.index1=t.target.value,this.formData.isAgent=this.yes_no[this.index1].dictValue},companyPay:function(t){this.index2=t.target.value,this.formData.companyPay=this.yes_no[this.index2].dictValue},payTypeFunc:function(t){this.index3=t.target.value,this.formData.payType=this.payType[this.index3].dictValue},payTypeProjectFunc:function(t){this.index7=t.target.value,this.formData.payType=this.payTypeProject[this.index7].dictValue},payType1Func:function(t){this.index4=t.target.value,this.details.payType=this.payType1[this.index4].dictValue},proCategoryFunc:function(t){var e=this;switch(this.index8=t.target.value,this.index9=0,this.index8){case 0:this.dictValue("sys_payment_small_type5").then((function(t){e.detailCategory=t.data})),console.log(this.index8);break;case 1:this.dictValue("sys_payment_small_type4").then((function(t){e.detailCategory=t.data})),console.log(this.index8);break;case 2:this.dictValue("sys_payment_small_type3").then((function(t){e.detailCategory=t.data})),console.log(this.index8);break;case 3:this.dictValue("sys_payment_small_type2").then((function(t){e.detailCategory=t.data})),console.log(this.index8);break;case 4:this.dictValue("sys_payment_small_type1").then((function(t){e.detailCategory=t.data})),console.log(this.index8);break}this.details.proCategory=this.proCategory[this.index8].dictValue},detailCategoryFunc:function(t){this.index9=t.target.value,this.details.detailCategory=this.detailCategory[this.index9].dictLabel},relationBillTypeFunc:function(t){this.index5=t.target.value,this.details.relationBillType=this.relationBillType[this.index5].dictValue},relationContractTypeFunc:function(t){this.index6=t.target.value,this.details.relationContractType=this.relationContractType[this.index6].dictValue},togglePopup:function(t,e,a){switch(t){case"top":this.content="顶部弹出 popup";break;case"bottom":this.content="底部弹出 popup";break;case"center":this.content="居中弹出 popup";break}"detail"==e&&(this.details={paymentReason:"",money:"",payType:"",payee:"",payeeAccount:"",payeeOpenBank:"",relationBillType:0,relationContractType:0,oweBillMoney:0,billExpirationDate:i.default.getDate("date"),oweContractMoney:0,contractExpirationDate:i.default.getDate("date"),relationBill:"",relationBillName:"",relationContract:"",relationContractName:""}),"2"==a&&(this.popupData.titile="工程",this.popupData.selectType="radio",this.popupData.url="oa/oaProject/phoneList",this.popupData.popupType="project"),"1"==a&&(this.popupData.titile="收款",this.popupData.selectType="radio",this.popupData.url="oa/oaReceivables/phoneList",this.popupData.popupType="oaReceivables"),"3"==a&&(this.popupData.titile="发票",this.popupData.selectType="radio",this.popupData.url="oa/sysProCostBill/phoneList",this.popupData.popupType="sysProCostBill"),"4"==a&&(this.popupData.titile="合同",this.popupData.selectType="radio",this.popupData.url="oa/oaContract/phoneList",this.popupData.popupType="contract"),this.type=t,this["show"+e]=!0},cancel:function(e,a){if("1"==a)if(this.formData.projectId)if(this.details.proCategory&&this.details.detailCategory){this.detailList.push(this.details),this.formData.money=parseFloat(this.formData.money)+parseFloat(this.details.money),this.Upcase(this.formData.money),this["show"+e]=!1;var i=this;this.urlRequestPost("oa/oaPayeeAccountInformation/phoneAdd",{payee:i.details.payee,account:i.details.payeeAccount,openingBank:i.details.payeeOpenBank},"application/json;charset=UTF-8",(function(t){console.log(t)}))}else t.showToast({title:"工程大类和工程小类必填",icon:"none"});else{this.detailList.push(this.details),this.formData.money=parseFloat(this.formData.money)+parseFloat(this.details.money),this.Upcase(this.formData.money),this["show"+e]=!1;var n=this;this.urlRequestPost("oa/oaPayeeAccountInformation/phoneAdd",{payee:n.details.payee,account:n.details.payeeAccount,openingBank:n.details.payeeOpenBank},"application/json;charset=UTF-8",(function(t){console.log(t)}))}else this["show"+e]=!1},dele:function(t){this.formData.money=parseFloat(this.formData.money)-parseFloat(this.detailList[t].money),this.Upcase(this.formData.money),this.detailList.splice(t,1)},change:function(t){t.show||(this.showdetail=!1)},getDeptV:function(t){this.formData.deptId=t.deptId,this.formData.companyId=t.companyId},getAttachmentList:function(t){this.attachmentList=t},getData:function(t){t[0].popupType&&("project"==t[0].popupType?(this.$set(this.formData,"projectId",t[0].id),this.$set(this.formData,"projectName",t[0].projectName),this.detailList=[]):"sysProCostBill"==t[0].popupType?(this.$set(this.details,"relationBill",t[0].id),this.$set(this.details,"relationBillName",t[0].name)):"contract"==t[0].popupType?(this.$set(this.details,"relationContract",t[0].id),this.$set(this.details,"relationContractName",t[0].contractName)):"oaReceivables"==t[0].popupType&&(this.$set(this.formData,"receivablesId",t[0].id),this.$set(this.formData,"receivablesName",t[0].code)))},popupState:function(t){this.showpopup=t},changeStart:function(t){console.log(t),this.formData.payDate=t},changeEnd:function(t){this.formData.expirationDate=t},changeEnd1:function(t){this.details.billExpirationDate=t},getPayeeList:function(){var t=this;this.urlRequestPost("oa/oaPayeeAccountInformation/list",{payee:t.details.payee},null,(function(e){console.log(e),t.payeeList=e.data}))},choicePayee:function(t){this.details.payee=this.payeeList[t].payee,this.details.payeeAccount=this.payeeList[t].account,this.details.payeeOpenBank=this.payeeList[t].openingBank,this.payeeList=[]}}};e.default=d}).call(this,a("543d")["default"])},"067b":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var i={dPicker:function(){return a.e("components/d-picker/d-picker").then(a.bind(null,"09d9"))},ePicker:function(){return Promise.all([a.e("common/vendor"),a.e("components/e-picker/e-picker")]).then(a.bind(null,"d113"))},uniUploader:function(){return Promise.all([a.e("common/vendor"),a.e("components/uni-uploader/uni-uploader")]).then(a.bind(null,"d7c2"))},uniIcons:function(){return Promise.all([a.e("common/vendor"),a.e("components/uni-icons/uni-icons")]).then(a.bind(null,"1581"))},uniPopup:function(){return a.e("components/uni-popup/uni-popup").then(a.bind(null,"d441"))},uniRelationPopup:function(){return a.e("components/uni-relation-popup/uni-relation-popup").then(a.bind(null,"4f53"))}},n=function(){var t=this,e=t.$createElement,a=(t._self._c,0!=t.detailList.length?t.__map(t.detailList,(function(e,a){var i=t.__get_orig(e),n=e.payType?t.getDictV(t.payType1,e.payType):null,o=e.proCategory?t.getDictV(t.proCategory,e.proCategory):null;return{$orig:i,m0:n,m1:o}})):null);t.$mp.data=Object.assign({},{$root:{l0:a}})},o=[]},"0ff3":function(t,e,a){"use strict";(function(t){a("8485");i(a("66fd"));var e=i(a("e787"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"5da7":function(t,e,a){"use strict";var i=a("5f44"),n=a.n(i);n.a},"5f44":function(t,e,a){},"85ce":function(t,e,a){"use strict";a.r(e);var i=a("0292"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},e787:function(t,e,a){"use strict";a.r(e);var i=a("067b"),n=a("85ce");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("5da7");var s,p=a("f0c5"),l=Object(p["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],s);e["default"]=l.exports}},[["0ff3","common/runtime","common/vendor"]]]);