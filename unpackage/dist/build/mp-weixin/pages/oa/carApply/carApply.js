(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/oa/carApply/carApply"],{"2cd2":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(a("05b7")),i=r(a("541c")),o=a("2f62");function r(t){return t&&t.__esModule?t:{default:t}}var s=function(){Promise.all([a.e("common/vendor"),a.e("components/uni-icons/uni-icons")]).then(function(){return resolve(a("1581"))}.bind(null,a)).catch(a.oe)},c=function(){a.e("components/uni-processList/nui-processList").then(function(){return resolve(a("8947"))}.bind(null,a)).catch(a.oe)},d=function(){a.e("components/d-picker/d-picker").then(function(){return resolve(a("09d9"))}.bind(null,a)).catch(a.oe)},u={components:{uniProcess:c,uniIcons:s,dPicker:d},data:function(){return{mid:"",edit:"",user:{},formData:{id:"",userName:"",companyId:"",deptId:"",applyTimeFrom:n.default.getDate("dateTime"),applyTimeTo:n.default.getDate("dateTime"),carNo:"",carUsed:0,driverInfo:"",passengerInfo:"",ridePlace:"",applyReason:"",destination:"",mileageStart:"",mileageEnd:"",mileage:"",designatedDriver:"",remark:"",status:""},carDetail:"",baseUrl:"oa/oaCarApply",addUrl:"oa/oaCarApply/add",saveUrl:"oa/oaCarApply/saveDraft",editUrl:"oa/oaCarApply/edit",flag:!1,date:n.default.getDate("dateTime"),dateStart:n.default.getDate("dateTime"),dateEnd:n.default.getDate("dateTime"),timeLimit:"",cardata:[],carLists:[],tiptext:"加载中.....",isLoading:!1,pageSize:3,pageNum:1,total:0,currentP:0,loading1:!1,loading2:!1,loading3:!1,procInstId:"",type:"",showcar:!1}},computed:(0,o.mapState)(["name","deptId","companyId","hasLogin"]),onLoad:function(t){this.edit=t.edit||"0",this.mid=t.id||"";var e=this;"0"==this.edit&&(this.$set(this.formData,"userName",this.name),this.$set(this.formData,"companyId",this.companyId),this.$set(this.formData,"deptId",this.deptId)),"1"==this.edit&&this.urlRequestGet(this.baseUrl+"/phoneEdit/"+this.mid,"text/html;charset=UTF-8",(function(t){console.log(t),n.default.listAssign(e.formData,t.data),e.procInstId=t.data.procInstId,e.carDetail=t.data.carNo})),this.getCarList()},methods:{submit:function(e){var a=this,n="",o=[{name:"applyTimeFrom",checkType:"notnull",checkRule:"",errorMsg:"出发时间必填"},{name:"applyTimeTo",checkType:"notnull",checkRule:"",errorMsg:"返回时间必填"},{name:"carNo",checkType:"notnull",checkRule:"",errorMsg:"车牌号必填"},{name:"passengerInfo",checkType:"notnull",checkRule:"",errorMsg:"乘客信息必填"},{name:"ridePlace",checkType:"notnull",checkRule:"",errorMsg:"乘车地点必填"},{name:"applyReason",checkType:"notnull",checkRule:"",errorMsg:"用车事由必填"},{name:"destination",checkType:"notnull",checkRule:"",errorMsg:"目的地必填"}],r=i.default.check(this.formData,o);if(r){switch(e){case"1":n=this.addUrl,this.loading2=!0;break;case"0":n=this.saveUrl,this.loading1=!0;break;case"2":n=this.editUrl,this.loading1=!0;break}console.log(this.formData),this.urlRequestPost(n,this.formData,null,(function(e){a.loading1=!1,a.loading2=!1,t.showToast({title:e.data.msg,icon:"none"}),"0"==e.data.code&&t.reLaunch({url:"../../start/start"})}))}else t.showToast({title:i.default.error,icon:"none"})},send:function(){t.navigateTo({url:"../../send/send?id="+this.mid+"&url="+this.baseUrl})},urge:function(){var e=this;this.loading3=!0,this.urlRequestGet(this.baseUrl+"/urge/"+this.mid,null,(function(a){t.showToast({title:a.data.msg,icon:"none"}),0==a.data.code&&(e.loading3=!1,t.reLaunch({url:"../../start/start"}))}))},getDictV:function(t,e){var a="";for(var n in t)t[n].dictValue==e&&(a=t[n].dictLabel);return a},changeStart:function(t){this.formData.applyTimeFrom=t,this.showValue=t,this.dateStart=t,this.getTimeLimit(this.dateStart,this.dateEnd)},changeEnd:function(t){this.formData.applyTimeTo=t,this.showValue=t,this.dateEnd=t,this.getTimeLimit(this.dateStart,this.dateEnd)},getTimeLimit:function(t,e){var a=this,n={};n.startTime=t,n.endTime=e,this.urlRequestPost(this.baseUrl+"/calculateHour",JSON.stringify(n),"application/json;charset=UTF-8",(function(t){console.log(t),0==t.data.code&&a.$set(a.formData,"carUsed",t.data.msg)}))},togglePopup:function(t,e){switch(t){case"top":this.content="顶部弹出 popup";break;case"bottom":this.content="底部弹出 popup";break;case"center":this.content="居中弹出 popup";break}this.type=t,this["show"+e]=!0},cancel:function(t,e){this["show"+t]=!1,"1"==e&&(this.$set(this.formData,"carNo",this.cardata[this.currentP].carNo),this.carDetail=this.cardata[this.currentP].carBrad+"-"+this.cardata[this.currentP].bodyColor+"-"+this.cardata[this.currentP].carNo,console.log(this.cardata))},ifadd:function(t){var e=!1;for(var a in this.sealdata)t==this.sealdata[a].id&&(e=!0);return e},change:function(t){t.show||(this.showcar=!1)},radioChange:function(t){for(var e=0;e<this.cardata.length;e++)if(this.cardata[e].id===t.target.value){this.currentP=e;break}},getCarList:function(){var t=this;this.urlRequestPost("oa/oaCar/phoneList",{pageSize:this.pageSize,pageNum:this.pageNum},null,(function(e){console.log(e);var a=t.cardata,n=[];for(var i in e.data.rows)n.push(e.data.rows[i]);t.pageNum<=1?t.cardata=n:t.cardata=a.concat(n),t.total=e.data.total}))},carlower:function(t){var e=this;setTimeout((function(){var t=Math.ceil(e.total/e.pageSize);e.pageNum<t?(e.pageNum++,e.getCarList()):e.tiptext="没有数据了！"}),500)},carDetailFun:function(){this.formData.carNo=this.carDetail},getDeptV:function(t){this.formData.deptId=t.deptId,this.formData.companyId=t.companyId}}};e.default=u}).call(this,a("543d")["default"])},4659:function(t,e,a){"use strict";(function(t){a("8485");n(a("66fd"));var e=n(a("b9e3"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"61d4":function(t,e,a){"use strict";a.r(e);var n=a("2cd2"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},"820d":function(t,e,a){"use strict";var n=a("af7d"),i=a.n(n);i.a},"930d":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var n={dPicker:function(){return a.e("components/d-picker/d-picker").then(a.bind(null,"09d9"))},ePicker:function(){return Promise.all([a.e("common/vendor"),a.e("components/e-picker/e-picker")]).then(a.bind(null,"d113"))},uniPopup:function(){return a.e("components/uni-popup/uni-popup").then(a.bind(null,"d441"))}},i=function(){var t=this,e=t.$createElement;t._self._c},o=[]},af7d:function(t,e,a){},b9e3:function(t,e,a){"use strict";a.r(e);var n=a("930d"),i=a("61d4");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("820d");var r,s=a("f0c5"),c=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);e["default"]=c.exports}},[["4659","common/runtime","common/vendor"]]]);