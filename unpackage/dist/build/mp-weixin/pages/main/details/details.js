(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/main/details/details"],{"04c2":function(t,e,a){"use strict";var n=a("e285"),i=a.n(n);i.a},"1a21":function(t,e,a){"use strict";a.r(e);var n=a("401c"),i=a.n(n);for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},"401c":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a("05b7")),i=s(a("296b")),o=a("2f62");function s(t){return t&&t.__esModule?t:{default:t}}var d=function(){Promise.all([a.e("common/vendor"),a.e("components/uni-icons/uni-icons")]).then(function(){return resolve(a("1581"))}.bind(null,a)).catch(a.oe)},r=function(){a.e("components/uni-steps/uni-steps").then(function(){return resolve(a("e0bf"))}.bind(null,a)).catch(a.oe)},c=function(){a.e("components/uni-popup/uni-popup").then(function(){return resolve(a("d441"))}.bind(null,a)).catch(a.oe)},u=function(){a.e("components/nui-details/nui-details").then(function(){return resolve(a("06ce"))}.bind(null,a)).catch(a.oe)},l={components:{uniIcons:d,uniPopup:c,uniSteps:r,uniDetails:u},data:function(){return{user:{},active:null,showtip:!1,showcont:!1,showqian:!1,showgui:!1,baseUrl:"",isLeaderPass:"",opinion:"",opinionCont:"",type:"",id:"",index:"",taskId:"",procInstId:"",approveData:{},attachmentUrl:[],processList:[],lastList:[],content:[],loading1:!1,loading2:!1,reim:{reason:"",money:0},pay:{reason:"",money:0},ifPc:!1,vo:{},formdata:{},formdata1:{},formdata2:{},replyOpinion:"",addApplier:[{dictLabel:"对方先签署原件已寄回公司"},{dictLabel:"我方先签署"}],index3:0,effectDate:n.default.getDate("date"),expirationDate:n.default.getDate("date")}},computed:(0,o.mapState)(["forcedLogin","hasLogin","userName"]),onLoad:function(t){this.type=t.type||"",this.id=t.id||"",this.taskId=t.taskId||"",this.index=t.index||"";var e=this,a="",n="";"0"==t.index?(a="system/sysUrge/setMapToPhone/"+t.id,n="application/json;charset=UTF-8"):"3"==t.index?(a="system/sysCopy/setMapToPhone/"+t.id,n="application/json;charset=UTF-8"):(a="oa/task/queryEventDetail/"+t.type+"/"+t.id+"/"+t.taskId,n=""),this.urlRequestGet(a,n,(function(a){if(console.log(a),a.data.phoneData&&"8"!=e.type&&"10"!=e.type){e.approveData=a.data.phoneData,e.type=a.data.phoneData.taskType;var n="";"0"==e.index||"3"==e.index?(n=a.data.phoneData.id,e.id=a.data.phoneData.id,"1"==a.data.phoneData.taskType&&(n=a.data.phoneData.leaveId)):n=e.id,e.procInstId=a.data.phoneData.procInstId,e.processListFun(a.data.phoneData.taskType,n),e.user=a.data.user,"2"==t.index&&e.urlRequestPost("oa/oaProcExeNode/selectNodeVoTableInfo",{actDefineId:a.data.phoneData.actDefineId,objId:e.id},null,(function(t){e.lastList=t.data.rows})),i.default.baseUrl(e.type)?e.ifPc=!0:e.ifPc=!1,e.urlRequestPost("/oa/oaAttachment/selectAttachByObjectId",{objId:n,sourceTable:a.data.phoneData.tableName},null,(function(t){e.attachmentUrl=t.data.data}))}else if("8"==e.type)if(a.data.vo){if(e.ifPc=!0,e.vo=a.data.vo,e.type=e.vo.oaContract.taskType,e.approveData=e.vo.oaContract,null!=e.vo.taskUserMapList)for(var o in e.vo.taskUserMapList)null!=e.vo.taskUserMapList[o]&&e.vo.taskUserMapList[o].assignee==e.vo.curUser.userId&&(e.formdata.taskId=e.vo.taskUserMapList[o].taskId,e.formdata.procInstId=e.vo.taskUserMapList[o].procInstId);"key1"==e.vo.nodeFlag&&(e.formdata.nodeFlag="key1");var s="";"0"==e.index||"3"==e.index?(s=a.data.phoneData.id,e.id=a.data.phoneData.id):s=e.id,e.urlRequestPost("/oa/oaAttachment/selectAttachByObjectId",{objId:s},null,(function(t){e.attachmentUrl=t.data.data}))}else e.ifPc=!1;else"10"==e.type&&(a.data?(e.ifPc=!0,e.vo=a.data.vo,e.approveData=a.data.vo.jyTender,e.formdata.taskId=a.data.vo.curDealMap.taskId):e.ifPc=!1)}))},methods:{processListFun:function(t,e){var a=this;this.urlRequestPost(i.default.baseUrl(t)+"/processList",{procInstId:this.procInstId,id:e},"application/json;charset=UTF-8",(function(t){a.processList=t.data.rows}))},ifAgree:function(t){this.opinion=i.default.ifAgree(t),this["showtip"]=!0,this.isLeaderPass=t},showComment:function(){this["showcont"]=!0},ifAgreeContract:function(e,a,n){var i=this;t.showLoading({title:"提交审核意见中"}),"0"==a?(this.formdata.pass=e,this.formdata.opinion=this.opinionCont,this.urlRequestPost("oa/oaContract/completeCurTask",this.formdata,null,(function(e){t.hideLoading(),t.showToast({title:e.data.msg,icon:"none"}),t.redirectTo({url:"../../main/details/details?type="+i.type+"&&id="+i.id+"&&taskId="+i.taskId+"&&index="+i.index})}))):(this.formdata1.id=n.commentId,this.formdata1.taskId=n.taskId,this.formdata1.procInstId=n.procInstId,this.formdata1.pass=e,this.formdata1.auditOpinion=this.opinionCont,this.formdata1.isAudit="Y",this.urlRequestPost("oa/oaContractComment/edit",this.formdata1,null,(function(e){t.hideLoading(),t.showToast({title:e.data.msg,icon:"none"}),t.redirectTo({url:"../../main/details/details?type="+i.type+"&&id="+i.id+"&&taskId="+i.taskId+"&&index="+i.index})})))},ifAgreeTender:function(e,a,n){var i=this;t.showLoading({title:"提交审核意见中"}),this.formdata.pass=e,this.formdata.opinion=this.opinionCont,this.urlRequestPost("business/jyTender/completeCurUserTask",this.formdata,null,(function(e){t.hideLoading(),t.showToast({title:e.data.msg,icon:"none"}),t.redirectTo({url:"../../main/details/details?type="+i.type+"&&id="+i.id+"&&taskId="+i.taskId+"&&index="+i.index})}))},cancel:function(e,a){if(this["showtip"]=!1,"yes"==a){var n=this;n.loading1=!0,n.urlRequestPost(i.default.baseUrl(this.type)+"/completeCurTask",{opinion:this.opinion,isLeaderPass:this.isLeaderPass,taskId:this.taskId,id:this.id,reason:this.reim.reason,money:this.reim.money},null,(function(e){t.showToast({title:e.data.msg,icon:"none"}),"0"==e.data.code&&t.reLaunch({url:"../../main/main"}),n.loading1=!1}))}},cancelCont:function(t,e){this["showcont"]=!1,"cancel"==e&&(this.formdata.opinion="",this.formdata1.auditOpinion="")},cancelqian:function(e,a){if(this["showqian"]=!1,"yes"==a){t.showLoading({title:"提交审核意见中"});var n=this;this.formdata.opinion=this.addApplier[this.index3].dictLabel,this.urlRequestPost("oa/oaContract/completeCurTask",this.formdata,null,(function(e){t.hideLoading(),t.showToast({title:e.data.msg,icon:"none"}),t.redirectTo({url:"../../main/details/details?type="+n.type+"&&id="+n.id+"&&taskId="+n.taskId+"&&index="+n.index})}))}},cancelgui:function(e,a){if(this["showgui"]=!1,"yes"==a){this.formdata.effectDate=this.effectDate,this.formdata.expirationDate=this.expirationDate,t.showLoading({title:"归档中"});var n=this;this.urlRequestPost("oa/oaContract/completeCurTask",this.formdata,null,(function(e){t.hideLoading(),t.showToast({title:e.data.msg,icon:"none"}),t.redirectTo({url:"../../main/details/details?type="+n.type+"&&id="+n.id+"&&taskId="+n.taskId+"&&index="+n.index})}))}},ifRetContract:function(e){this.formdata2.taskId=e.taskId,this.formdata2.procInstId=e.procInstId,this.formdata2.id=e.commentId,this.formdata2.isAudit="N",this.formdata2.replyOpinion=this.replyOpinion,t.showLoading({title:"提交回复意见中"});var a=this;this.urlRequestPost("oa/oaContractComment/edit",this.formdata2,null,(function(e){t.hideLoading(),t.showToast({title:e.data.msg,icon:"none"}),t.redirectTo({url:"../../main/details/details?type="+a.type+"&&id="+a.id+"&&taskId="+a.taskId+"&&index="+a.index})}))},addApplierFunc:function(t){this.index3=t.target.value},selectApplier:function(){this["showqian"]=!0},showGui:function(){this["showgui"]=!0},changeStart:function(t){this.effectDate=t},changeEnd:function(t){this.expirationDate=t},change:function(t){t.show||(this.showtip=!1,this.showcont=!1,this.showqian=!1)},send:function(){t.navigateTo({url:"../../send/send?id="+this.id+"&url="+i.default.baseUrl(this.type)})},lastNode:function(e){var a={};a.parentId=this.id,a.userId=this.lastList[e].node.userId,a.content=this.content[e],a.attachmentList=[];this.urlRequestPost(i.default.baseUrl(this.type)+"/insertExeComment",a,"application/json;charset=UTF-8",(function(e){t.showToast({title:e.data.msg,icon:"none"}),0==e.data.code&&t.reLaunch({url:"../../main/main"})}))}},onBackPress:function(){if(this.showtip)return this.showtip=!1,!0}};e.default=l}).call(this,a("543d")["default"])},"7fae":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var n={uniSteps:function(){return a.e("components/uni-steps/uni-steps").then(a.bind(null,"e0bf"))},uniPopup:function(){return a.e("components/uni-popup/uni-popup").then(a.bind(null,"d441"))},ePicker:function(){return Promise.all([a.e("common/vendor"),a.e("components/e-picker/e-picker")]).then(a.bind(null,"d113"))}},i=function(){var t=this,e=t.$createElement;t._self._c},o=[]},c9ee:function(t,e,a){"use strict";(function(t){a("8485");n(a("66fd"));var e=n(a("ede9"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},e285:function(t,e,a){},ede9:function(t,e,a){"use strict";a.r(e);var n=a("7fae"),i=a("1a21");for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("04c2");var s,d=a("f0c5"),r=Object(d["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);e["default"]=r.exports}},[["c9ee","common/runtime","common/vendor"]]]);